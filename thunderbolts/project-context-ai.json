{
  "jsconfig.json": "{\n  \"compilerOptions\": {\n    \"paths\": {\n      \"@/*\": [\"./src/*\"]\n    }\n  }\n}\n",
  "package-lock.json": "{\n  \"name\": \"thunderbolts\",\n  \"version\": \"0.1.0\",\n  \"lockfileVersion\": 3,\n  \"requires\": true,\n  \"packages\": {\n    \"\": {\n      \"name\": \"thunderbolts\",\n      \"version\": \"0.1.0\",\n      \"dependencies\": {\n        \"@auth/mongodb-adapter\": \"^3.11.1\",\n        \"bcryptjs\": \"^3.0.3\",\n        \"lucide-react\": \"^0.563.0\",\n        \"mongodb\": \"^6.21.0\",\n        \"mongoose\": \"^9.1.5\",\n        \"next\": \"16.1.6\",\n        \"next-auth\": \"^4.24.13\",\n        \"react\": \"19.2.3\",\n        \"react-dom\": \"19.2.3\"\n      },\n      \"devDependencies\": {\n        \"@tailwindcss/postcss\": \"^4\",\n        \"eslint\": \"^9\",\n        \"eslint-config-next\": \"16.1.6\",\n        \"tailwindcss\": \"^4\"\n      }\n    },\n    \"node_modules/@alloc/quick-lru\": {\n      \"version\": \"5.2.0\",\n      \"resolved\": \"https://registry.npmjs.org/@alloc/quick-lru/-/quick-lru-5.2.0.tgz\",\n      \"integrity\": \"sha512-UrcABB+4bUrFABwbluTIBErXwvbsU/V7TZWfmbgJfbkwiBuziS9gxdODUyuiecfdGQ85jglMW6juS3+z5TsKLw==\",\n      \"dev\": true,\n      \"license\": \"MIT\",\n      \"engines\": {\n        \"node\": \">=10\"\n      },\n      \"funding\": {\n        \"url\": \"https://github.com/sponsors/sindresorhus\"\n      }\n    },\n    \"node_modules/@auth/core\": {\n      \"version\": \"0.34.3\",\n      \"resolved\": \"https://registry.npmjs.org/@auth/core/-/core-0.34.3.tgz\",\n      \"integrity\": \"sha512-jMjY/S0doZnWYNV90x0jmU3B+UcrsfGYnukxYrRbj0CVvGI/MX3JbHsxSrx2d4mbnXaUsqJmAcDfoQWA6r0lOw==\",\n      \"license\": \"ISC\",\n      \"optional\": true,\n      \"peer\": true,\n      \"dependencies\": {\n        \"@panva/hkdf\": \"^1.1.1\",\n        \"@types/cookie\": \"0.6.0\",\n        \"cookie\": \"0.6.0\",\n        \"jose\": \"^5.1.3\",\n        \"oauth4webapi\": \"^2.10.4\",\n        \"preact\": \"10.11.3\",\n        \"preact-render-to-string\": \"5.2.3\"\n      },\n      \"peerDependencies\": {\n        \"@simplewebauthn/browser\": \"^9.0.1\",\n        \"@simplewebauthn/server\": \"^9.0.2\",\n        \"nodemailer\": \"^7\"\n      },\n      \"peerDependenciesMeta\": {\n        \"@simplewebauthn/browser\": {\n          \"optional\": true\n        },\n        \"@simplewebauthn/server\": {\n          \"optional\": true\n        },\n        \"nodemailer\": {\n          \"optional\": true\n        }\n      }\n    },\n    \"node_modules/@auth/core/node_modules/cookie\": {\n      \"version\": \"0.6.0\",\n      \"resolved\": \"https://registry.npmjs.org/cookie/-/cookie-0.6.0.tgz\",\n      \"integrity\": \"sha512-U71cyTamuh1CRNCfpGY6to28lxvNwPG4Guz/EVjgf3Jmzv0vlDp1atT9eS5dDjMYHucpHbWns6Lwf3BKz6svdw==\",\n      \"license\": \"MIT\",\n      \"optional\": true,\n      \"peer\": true,\n      \"engines\": {\n        \"node\": \">= 0.6\"\n      }\n    },\n    \"node_modules/@auth/core/node_modules/jose\": {\n      \"version\": \"5.10.0\",\n      \"resolved\": \"https://registry.npmjs.org/jose/-/jose-5.10.0.tgz\",\n      \"integrity\": \"sha512-s+3Al/p9g32Iq+oqXxkW//7jk2Vig6FF1CFqzVXoTUXt2qz89YWbL+OwS17NFYEvxC35n0FKeGO2LGYSxeM2Gg==\",\n      \"license\": \"MIT\",\n      \"optional\": true,\n      \"peer\": true,\n      \"funding\": {\n        \"url\": \"https://github.com/sponsors/panva\"\n      }\n    },\n    \"node_modules/@auth/core/node_modules/preact\": {\n      \"version\": \"10.11.3\",\n      \"resolved\": \"https://registry.npmjs.org/preact/-/preact-10.11.3.tgz\",\n      \"integrity\": \"sha512-eY93IVpod/zG3uMF22Unl8h9KkrcKIRs2EGar8hwLZZDU1lkjph303V9HZBwufh2s736U6VXuhD109LYqPoffg==\",\n      \"license\": \"MIT\",\n      \"optional\": true,\n      \"peer\": true,\n      \"funding\": {\n        \"type\": \"opencollective\",\n        \"url\": \"https://opencollective.com/preact\"\n      }\n    },\n    \"node_modules/@auth/core/node_modules/preact-render-to-string\": {\n      \"version\": \"5.2.3\",\n      \"resolved\": \"https://registry.npmjs.org/preact-render-to-string/-/preact-render-to-string-5.2.3.tgz\",\n      \"integrity\": \"sha512-aPDxUn5o3GhWdtJtW0svRC2SS/l8D9MAgo2+AWml+BhDImb27ALf04Q2d+AHqUUOc6RdSXFIBVa2gxzgMKgtZA==\",\n      \"license\": \"MIT\",\n      \"optional\": true,\n      \"peer\": true,\n      \"dependencies\": {\n        \"pretty-format\": \"^3.8.0\"\n      },\n      \"peerDependencies\": {\n        \"preact\": \">=10\"\n      }\n    },\n    \"node_modules/@auth/mongodb-adapter\": {\n      \"version\": \"3.11.1\",\n      \"resolved\": \"https://registry.npmjs.org/@auth/mongodb-adapter/-/mongodb-adapter-3.11.1.tgz\",\n      \"integrity\": \"sha512-xY+VUkC3CNXct8UwQgBAQqXASqolSlIARg6oAm1378CtRN2650tQUCOEnGLNLmroVefUeP73M6t+TpGXq72vwQ==\",\n      \"license\": \"ISC\",\n      \"dependencies\": {\n        \"@auth/core\": \"0.41.1\"\n      },\n      \"peerDependencies\": {\n        \"mongodb\": \"^6\"\n      }\n    },\n    \"node_modules/@auth/mongodb-adapter/node_modules/@auth/core\": {\n      \"version\": \"0.41.1\",\n      \"resolved\": \"https://registry.npmjs.org/@auth/core/-/core-0.41.1.tgz\",\n      \"integrity\": \"sha512-t9cJ2zNYAdWMacGRMT6+r4xr1uybIdmYa49calBPeTqwgAFPV/88ac9TEvCR85pvATiSPt8VaNf+Gt24JIT/uw==\",\n      \"license\": \"ISC\",\n      \"dependencies\": {\n        \"@panva/hkdf\": \"^1.2.1\",\n        \"jose\": \"^6.0.6\",\n        \"oauth4webapi\": \"^3.3.0\",\n        \"preact\": \"10.24.3\",\n        \"preact-render-to-string\": \"6.5.11\"\n      },\n      \"peerDependencies\": {\n        \"@simplewebauthn/browser\": \"^9.0.1\",\n        \"@simplewebauthn/server\": \"^9.0.2\",\n        \"nodemailer\": \"^7.0.7\"\n      },\n      \"peerDependenciesMeta\": {\n        \"@simplewebauthn/browser\": {\n          \"optional\": true\n        },\n        \"@simplewebauthn/server\": {\n          \"optional\": true\n        },\n        \"nodemailer\": {\n          \"optional\": true\n        }\n      }\n    },\n    \"node_modules/@auth/mongodb-adapter/node_modules/jose\": {\n      \"version\": \"6.1.3\",\n      \"resolved\": \"https://registry.npmjs.org/jose/-/jose-6.1.3.tgz\",\n      \"integrity\": \"sha512-0TpaTfihd4QMNwrz/ob2Bp7X04yuxJkjRGi4aKmOqwhov54i6u79oCv7T+C7lo70MKH6BesI3vscD1yb/yzKXQ==\",\n      \"license\": \"MIT\",\n      \"funding\": {\n        \"url\": \"https://github.com/sponsors/panva\"\n      }\n    },\n    \"node_modules/@auth/mongodb-adapter/node_modules/oauth4webapi\": {\n      \"version\": \"3.8.3\",\n      \"resolved\": \"https://registry.npmjs.org/oauth4webapi/-/oauth4webapi-3.8.3.tgz\",\n      \"integrity\": \"sha512-pQ5BsX3QRTgnt5HxgHwgunIRaDXBdkT23tf8dfzmtTIL2LTpdmxgbpbBm0VgFWAIDlezQvQCTgnVIUmHupXHxw==\",\n      \"license\": \"MIT\",\n\n\n// ‚úÇÔ∏è Truncated for AI (original 247786 characters)",
  "package.json": "{\n  \"name\": \"thunderbolts\",\n  \"version\": \"0.1.0\",\n  \"private\": true,\n  \"scripts\": {\n    \"dev\": \"next dev\",\n    \"build\": \"next build\",\n    \"start\": \"next start\",\n    \"lint\": \"eslint\"\n  },\n  \"dependencies\": {\n    \"@auth/mongodb-adapter\": \"^3.11.1\",\n    \"bcryptjs\": \"^3.0.3\",\n    \"lucide-react\": \"^0.563.0\",\n    \"mongodb\": \"^6.21.0\",\n    \"mongoose\": \"^9.1.5\",\n    \"next\": \"16.1.6\",\n    \"next-auth\": \"^4.24.13\",\n    \"react\": \"19.2.3\",\n    \"react-dom\": \"19.2.3\"\n  },\n  \"devDependencies\": {\n    \"@tailwindcss/postcss\": \"^4\",\n    \"eslint\": \"^9\",\n    \"eslint-config-next\": \"16.1.6\",\n    \"tailwindcss\": \"^4\"\n  }\n}\n",
  "project-context-ai.json": "{}",
  "src\\app\\(auth)\\log-in\\page.js": "\"use client\";\r\nimport React, { useState } from 'react';\r\nimport { signIn } from 'next-auth/react';\r\nimport { useRouter } from 'next/navigation';\r\n\r\nexport default function LoginPage() {\r\n  const router = useRouter();\r\n  const [role, setRole] = useState('donor'); // 'donor' or 'ngo'\r\n  const [loading, setLoading] = useState(false);\r\n  const [error, setError] = useState(\"\");\r\n\r\n  const [formData, setFormData] = useState({\r\n    email: \"\",\r\n    password: \"\",\r\n  });\r\n\r\n const handleSubmit = async (e) => {\r\n  e.preventDefault();\r\n  setLoading(true);\r\n  setError(\"\");\r\n\r\n  try {\r\n    const result = await signIn(\"credentials\", {\r\n  redirect: false,\r\n  email: formData.email,\r\n  password: formData.password,\r\n  // role: role,   ‚Üê removed!\r\n});\r\n\r\n    if (result?.error) {\r\n      // result.error contains the string returned from your authorize function\r\n      setError(result.error === \"CredentialsSignin\" ? \"Invalid email or password\" : result.error);\r\n    } else {\r\n      // Force a hard refresh to ensure the session is picked up by the layout\r\n      window.location.href = role === 'donor' ? '/donor' : '/organisation';\r\n    }\r\n  } catch (err) {\r\n    setError(\"An unexpected error occurred.\");\r\n  } finally {\r\n    setLoading(false);\r\n  }\r\n};\r\n\r\n  return (\r\n    <div className=\"min-h-screen flex items-center justify-center bg-white text-slate-900 font-sans\">\r\n      <div className=\"w-full max-w-md p-8 border border-slate-200\">\r\n        {/* Header */}\r\n        <div className=\"mb-10 text-center\">\r\n          <h1 className=\"text-2xl font-bold tracking-tight uppercase\">FoodLink Login</h1>\r\n          <p className=\"text-sm text-slate-500 mt-2\">Team ThunderBolts ‚Ä¢ Problem CS01SW</p>\r\n        </div>\r\n\r\n        {/* Role Selection */}\r\n        <div className=\"flex mb-8 border border-slate-900\">\r\n          <button\r\n            type=\"button\"\r\n            onClick={() => setRole('donor')}\r\n            className={`flex-1 py-3 text-sm font-bold transition-colors ${\r\n              role === 'donor' ? 'bg-slate-900 text-white' : 'bg-transparent text-slate-900 hover:bg-slate-50'\r\n            }`}\r\n          >\r\n            DONOR\r\n          </button>\r\n          <button\r\n            type=\"button\"\r\n            onClick={() => setRole('ngo')}\r\n            className={`flex-1 py-3 text-sm font-bold transition-colors ${\r\n              role === 'ngo' ? 'bg-slate-900 text-white' : 'bg-transparent text-slate-900 hover:bg-slate-50'\r\n            }`}\r\n          >\r\n            NGO\r\n          </button>\r\n        </div>\r\n\r\n        {/* Error Message */}\r\n        {error && (\r\n          <div className=\"mb-6 p-3 bg-red-50 border-l-4 border-red-500 text-red-700 text-xs font-bold uppercase\">\r\n            {error}\r\n          </div>\r\n        )}\r\n\r\n        {/* Form */}\r\n        <form className=\"space-y-6\" onSubmit={handleSubmit}>\r\n          <div>\r\n            <label className=\"block text-xs font-bold uppercase tracking-wider mb-2\">Email Address</label>\r\n            <input \r\n              required\r\n              type=\"email\" \r\n              placeholder=\"email@example.com\"\r\n              value={formData.email}\r\n              onChange={(e) => setFormData({...formData, email: e.target.value})}\r\n              className=\"w-full px-4 py-3 border border-slate-300 focus:border-slate-900 focus:outline-none transition-colors\"\r\n            />\r\n          </div>\r\n\r\n          <div>\r\n            <label className=\"block text-xs font-bold uppercase tracking-wider mb-2\">Password</label>\r\n            <input \r\n              required\r\n              type=\"password\" \r\n              placeholder=\"‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢\"\r\n              value={formData.password}\r\n              onChange={(e) => setFormData({...formData, password: e.target.value})}\r\n              className=\"w-full px-4 py-3 border border-slate-300 focus:border-slate-900 focus:outline-none transition-colors\"\r\n            />\r\n          </div>\r\n\r\n          <div className=\"flex items-center justify-between text-xs font-medium\">\r\n            <label className=\"flex items-center space-x-2 cursor-pointer\">\r\n              <input type=\"checkbox\" className=\"w-4 h-4 border-slate-900 rounded-none accent-slate-900\" />\r\n              <span>Remember me</span>\r\n            </label>\r\n            <a href=\"#\" className=\"underline hover:text-emerald-600 transition\">Forgot Password?</a>\r\n          </div>\r\n\r\n          <button \r\n            type=\"submit\"\r\n            disabled={loading}\r\n            className={`w-full py-4 font-bold uppercase tracking-widest transition-colors ${\r\n              loading ? 'bg-slate-400 cursor-not-allowed' : 'bg-emerald-600 hover:bg-emerald-700'\r\n            } text-white`}\r\n          >\r\n            {loading ? \"Authenticating...\" : `Sign In as ${role}`}\r\n          </button>\r\n        </form>\r\n\r\n        {/* Footer Link */}\r\n        <div className=\"mt-8 text-center text-sm\">\r\n          <span className=\"text-slate-500\">New to FoodLink? </span>\r\n          <a href=\"/register\" className=\"font-bold underline hover:text-emerald-600 transition\">Create Account</a>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}",
  "src\\app\\(auth)\\register\\page.js": "\"use client\";\r\nimport React, { useState } from 'react';\r\nimport { useRouter } from 'next/navigation';\r\nimport { registerUser } from '@/features/auth/actions';\r\n\r\nexport default function RegisterPage() {\r\n  const router = useRouter();\r\n  const [role, setRole] = useState('donor');\r\n  const [loading, setLoading] = useState(false);\r\n  const [error, setError] = useState(\"\");\r\n\r\n  const handleSubmit = async (e) => {\r\n    e.preventDefault();\r\n    setLoading(true);\r\n    const formData = new FormData(e.target);\r\n    const data = Object.fromEntries(formData.entries());\r\n    data.role = role;\r\n\r\n    const result = await registerUser(data);\r\n    if (result.success) {\r\n      router.push('/log-in?registered=true');\r\n    } else {\r\n      setError(result.error);\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"min-h-screen py-12 flex items-center justify-center bg-white text-slate-900 font-sans\">\r\n      <div className=\"w-full max-w-2xl p-8 border border-slate-200\">\r\n        <div className=\"mb-10 text-center\">\r\n          <h1 className=\"text-2xl font-bold tracking-tight uppercase\">Create Account</h1>\r\n          <p className=\"text-sm text-slate-500 mt-2\">Join Team ThunderBolts FoodLink Network</p>\r\n        </div>\r\n\r\n        <div className=\"flex mb-8 border border-slate-900\">\r\n          <button type=\"button\" onClick={() => setRole('donor')} className={`flex-1 py-3 text-sm font-bold ${role === 'donor' ? 'bg-slate-900 text-white' : ''}`}>DONOR</button>\r\n          <button type=\"button\" onClick={() => setRole('ngo')} className={`flex-1 py-3 text-sm font-bold ${role === 'ngo' ? 'bg-slate-900 text-white' : ''}`}>NGO</button>\r\n        </div>\r\n\r\n        {error && <div className=\"mb-6 p-3 bg-red-50 border-l-4 border-red-500 text-red-700 text-xs font-bold uppercase\">{error}</div>}\r\n\r\n        <form className=\"space-y-6\" onSubmit={handleSubmit}>\r\n          {/* Base Credentials */}\r\n          <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\r\n            <input name=\"email\" required type=\"email\" placeholder=\"Email Address\" className=\"w-full px-4 py-3 border border-slate-300 focus:border-slate-900 outline-none\" />\r\n            <input name=\"password\" required type=\"password\" placeholder=\"Password\" className=\"w-full px-4 py-3 border border-slate-300 focus:border-slate-900 outline-none\" />\r\n          </div>\r\n\r\n          <hr className=\"border-slate-100\" />\r\n\r\n          {role === 'donor' ? (\r\n            <div className=\"space-y-4\">\r\n              <h3 className=\"font-bold text-xs uppercase tracking-widest text-emerald-600\">Donor Profile</h3>\r\n              <input name=\"name\" required placeholder=\"Full Name / Business Name\" className=\"w-full px-4 py-3 border border-slate-300 outline-none\" />\r\n              <select name=\"donorType\" className=\"w-full px-4 py-3 border border-slate-300 outline-none\">\r\n                <option value=\"Individual\">Individual</option>\r\n                <option value=\"Restaurant\">Restaurant</option>\r\n                <option value=\"Hotel\">Hotel</option>\r\n              </select>\r\n              <input name=\"phoneNumber\" required placeholder=\"Contact Number\" className=\"w-full px-4 py-3 border border-slate-300 outline-none\" />\r\n            </div>\r\n          ) : (\r\n            <div className=\"space-y-4\">\r\n              <h3 className=\"font-bold text-xs uppercase tracking-widest text-emerald-600\">NGO Verification Form</h3>\r\n              <input name=\"ngoName\" required placeholder=\"Official NGO Name\" className=\"w-full px-4 py-3 border border-slate-300 outline-none\" />\r\n              \r\n              <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\r\n                <select name=\"ngoType\" className=\"w-full px-4 py-3 border border-slate-300 outline-none\">\r\n                  <option value=\"\">Type of NGO</option>\r\n                  <option value=\"Food Bank\">Food Bank</option>\r\n                  <option value=\"Orphanage\">Orphanage</option>\r\n                  <option value=\"Shelter Home\">Shelter Home</option>\r\n                </select>\r\n                <select name=\"registrationType\" className=\"w-full px-4 py-3 border border-slate-300 outline-none\">\r\n                  <option value=\"\">Registration Type</option>\r\n                  <option value=\"Society\">Society</option>\r\n                  <option value=\"Trust\">Trust</option>\r\n                  <option value=\"Section 8 Company\">Section 8 Company</option>\r\n                </select>\r\n              </div>\r\n\r\n              <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\r\n                <input name=\"registrationNumber\" required placeholder=\"Reg. Number\" className=\"w-full px-4 py-3 border border-slate-300 outline-none\" />\r\n                <input name=\"ngoDarpanId\" placeholder=\"NGO Darpan ID\" className=\"w-full px-4 py-3 border border-slate-300 outline-none\" />\r\n              </div>\r\n\r\n              <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\r\n                <input name=\"reg12A\" placeholder=\"12A Number\" className=\"w-full px-4 py-3 border border-slate-300 outline-none\" />\r\n                <input name=\"reg80G\" placeholder=\"80G Certificate Number\" className=\"w-full px-4 py-3 border border-slate-300 outline-none\" />\r\n              </div>\r\n\r\n              <textarea name=\"address\" required placeholder=\"Full Address with PIN Code\" className=\"w-full px-4 py-3 border border-slate-300 outline-none h-24\" />\r\n              <input name=\"beneficiaryCapacity\" type=\"number\" placeholder=\"Beneficiary Capacity (e.g. 100)\" className=\"w-full px-4 py-3 border border-slate-300 outline-none\" />\r\n            </div>\r\n          )}\r\n\r\n          <button type=\"submit\" disabled={loading} className=\"w-full bg-emerald-600 text-white py-4 font-bold uppercase tracking-widest hover:bg-emerald-700 transition-colors\">\r\n            {loading ? \"Processing...\" : `Register as ${role}`}\r\n          </button>\r\n        </form>\r\n         {/* Footer Link */}\r\n        <div className=\"mt-8 text-center text-sm\">\r\n          <span className=\"text-slate-500\">Already been to F\n\n// ‚úÇÔ∏è Truncated for AI (original 6174 characters)",
  "src\\app\\(donor)\\donor\\page.js": "import React from \"react\";\r\nimport connectDB from \"@/lib/db\";\r\nimport User from \"@/models/User\";\r\nimport Listing from \"@/models/Listing\";\r\nimport NGOCard from \"@/features/donor/components/NgoCards\";\r\nimport SearchNGOs from \"@/features/donor/components/SearchNGOs\";\r\nimport DonationForm from \"@/features/donor/components/DonationForm\";\r\nimport HandoverButton from \"@/features/donor/components/HandoverButton\";\r\nimport { getServerSession } from \"next-auth\";\r\nimport { authOptions } from \"@/app/api/auth/[...nextauth]/route\";\r\nimport { Plus, Inbox, Clock, PackageCheck, AlertCircle } from \"lucide-react\";\r\nimport Link from \"next/link\";\r\n\r\nexport default async function DonorDashboard({ searchParams }) {\r\n  const session = await getServerSession(authOptions);\r\n  const userId = session?.user?.id;\r\n  const userEmail = session?.user?.email || \"Guest\";\r\n  const initial = userEmail.charAt(0).toUpperCase();\r\n\r\n  try {\r\n    await connectDB();\r\n\r\n    // 1. Fetch Donor's active listings\r\n    const myDonations = await Listing.find({\r\n      donorId: userId,\r\n      status: { $in: [\"available\", \"claimed\"] },\r\n    })\r\n      .sort({ createdAt: -1 })\r\n      .lean();\r\n\r\n    // 2. NGO Discovery Logic\r\n    const query = (await searchParams).query || \"\";\r\n    const filter = { role: \"ngo\", status: \"approved\" };\r\n\r\n    if (query) {\r\n      filter.$or = [\r\n        { \"ngoDetails.ngoName\": { $regex: query, $options: \"i\" } },\r\n        { \"ngoDetails.address\": { $regex: query, $options: \"i\" } },\r\n        { \"ngoDetails.ngoType\": { $regex: query, $options: \"i\" } },\r\n      ];\r\n    }\r\n\r\n    const ngos = await User.find(filter).sort({ createdAt: -1 }).lean();\r\n\r\n    const groupedNgos = ngos.reduce((acc, ngo) => {\r\n      const category = ngo.ngoDetails?.ngoType || \"Other\";\r\n      if (!acc[category]) acc[category] = [];\r\n      acc[category].push(ngo);\r\n      return acc;\r\n    }, {});\r\n\r\n    return (\r\n      <div className='min-h-screen bg-[#FDFDFD] text-slate-900 selection:bg-emerald-100'>\r\n        {/* Navbar */}\r\n        <nav className='sticky top-0 z-30 bg-white/80 backdrop-blur-md border-b border-slate-100'>\r\n          <div className='max-w-7xl mx-auto px-6 h-16 flex items-center justify-between'>\r\n            <div className='flex items-center gap-2'>\r\n              <img src=\"/logo.jpeg\" alt=\"Logo\" className=\"w-8 h-8 rounded-md\" />\r\n              <span className='font-bold tracking-tight text-lg'>FOODLINK</span>\r\n            </div>\r\n\r\n            <div className='flex items-center gap-6'>\r\n              <SearchNGOs />\r\n              <div\r\n                title={userEmail}\r\n                className='h-9 w-9 bg-emerald-50 border border-emerald-100 rounded-full flex items-center justify-center'\r\n              >\r\n                <span className='text-emerald-700 font-bold text-sm'>{initial}</span>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </nav>\r\n\r\n        <main className='max-w-7xl mx-auto px-6 py-10'>\r\n          {/* MANAGEMENT SECTION */}\r\n          <section className='mb-16 grid grid-cols-1 lg:grid-cols-12 gap-8'>\r\n            <div className='lg:col-span-4'>\r\n              <DonationForm />\r\n            </div>\r\n\r\n            <div className='lg:col-span-8 bg-white border border-slate-100 rounded-2xl p-6 shadow-sm'>\r\n              <div className='flex items-center justify-between mb-6'>\r\n                <h3 className='text-xs font-bold uppercase tracking-widest text-slate-400 flex items-center gap-2'>\r\n                  <Clock size={14} /> Your Live Listings\r\n                </h3>\r\n                <Link href=\"/history\" className=\"text-[10px] font-bold text-emerald-600 uppercase hover:underline\">\r\n                  View Full History\r\n                </Link>\r\n              </div>\r\n\r\n              {myDonations.length > 0 ? (\r\n                <div className='grid grid-cols-1 md:grid-cols-2 gap-4'>\r\n                  {myDonations.map((item) => (\r\n                    <div\r\n                      key={item._id.toString()}\r\n                      className={`p-4 border rounded-xl transition-all ${\r\n                        item.status === 'claimed' ? 'border-amber-200 bg-amber-50/30' : 'border-slate-100 bg-slate-50/50'\r\n                      }`}\r\n                    >\r\n                      <h4 className='font-bold text-slate-800'>{item.title}</h4>\r\n                      <p className='text-xs text-slate-500 mt-1'>\r\n                        {item.quantity} ‚Ä¢ {item.foodType}\r\n                      </p>\r\n\r\n                      {item.status === \"claimed\" && (\r\n                        <div className='mt-4 pt-4 border-t border-amber-100'>\r\n                          <div className='flex items-center gap-2 text-amber-700 mb-3'>\r\n                            <PackageCheck size={14} />\r\n                            <span className='text-[10px] font-bold uppercase tracking-tight'>\r\n                              Action Required: Handover to NGO\r\n                            </span>\r\n                          </div>\r\n                          <HandoverButton listingId={item._id.toString()} />\r\n                        </div>\r\n                      )}\r\n                    </div>\r\n                  ))}\r\n                </div>\r\n              ) : (\r\n                <div className='h-40 flex flex-col items-center justify-center text-slate-400 border border-dashed rounded-xl'>\r\n                  <p className='text-sm italic font-medium'>No active listings found.</p>\r\n                </div>\r\n              )}\r\n            </div>\r\n          </section>\r\n\r\n          {/* NGO DISCOVERY SECTION */}\r\n          <header className='mb-8 flex items-center justify-between'>\r\n            <h2 className='text-2xl font-black tracking-tight text-slate-900'>\r\n              {query ? `Results for \"${query}\"` : \"Partner NGOs\"}\r\n            </h2>\r\n          </header>\r\n\r\n          {Object.keys(groupedNgos).length > 0 ? (\r\n            Object.keys(groupedNgos).map((category) => (\r\n              <section key={category} className='mb-12'>\r\n                <div className='fl\n\n// ‚úÇÔ∏è Truncated for AI (original 7956 characters)",
  "src\\app\\(donor)\\layout.js": "import React from 'react'\r\n\r\nfunction layout({children}) {\r\n  return (\r\n    <div>{children}</div>\r\n  )\r\n}\r\n\r\nexport default layout",
  "src\\app\\(organisation)\\layout.js": "import React from 'react'\r\n\r\nfunction layout({children}) {\r\n  return (\r\n    <div>{children}</div>\r\n  )\r\n}\r\n\r\nexport default layout",
  "src\\app\\(organisation)\\organisation\\page.js": "import React from \"react\";\r\nimport Link from \"next/link\";\r\nimport { getServerSession } from \"next-auth\";\r\nimport { authOptions } from \"@/app/api/auth/[...nextauth]/route\";\r\nimport connectDB from \"@/lib/db\";\r\nimport Listing from \"@/models/Listing\";\r\nimport { MapPin, Clock, PackageCheck, Info, ExternalLink } from \"lucide-react\";\r\nimport ClaimButton from \"@/features/organisation/components/ClaimButton\";\r\n\r\nexport default async function NGODashboard({ searchParams }) {\r\n  const session = await getServerSession(authOptions);\r\n  const userId = session?.user?.id;\r\n  const activeTab = (await searchParams).tab || \"available\";\r\n\r\n  await connectDB();\r\n\r\n  // 1. Parallelize data fetching to reduce waterfall latency\r\n  const [listings, pickupCount] = await Promise.all([\r\n    fetchListings(activeTab, userId),\r\n    Listing.countDocuments({ claimedBy: userId, status: \"claimed\" })\r\n  ]);\r\n\r\n  return (\r\n    <div className='min-h-screen bg-[#F8FAFC] p-6 selection:bg-emerald-100'>\r\n      <div className='max-w-6xl mx-auto'>\r\n        <header className='mb-8 flex flex-col md:flex-row md:items-end justify-between gap-4'>\r\n          <div>\r\n            <h1 className='text-3xl font-black text-slate-900 tracking-tight'>NGO Operations</h1>\r\n            <p className='text-slate-500 text-sm'>Manage your food collection and distributions.</p>\r\n          </div>\r\n          <Link\r\n            href='/history'\r\n            className='text-[10px] font-bold text-slate-400 hover:text-emerald-600 uppercase tracking-widest border border-slate-200 px-4 py-2 rounded-full transition-all bg-white shadow-sm'\r\n          >\r\n            View Impact History\r\n          </Link>\r\n        </header>\r\n\r\n        {/* --- Tab Navigation (Optimized with Link) --- */}\r\n        <div className='flex gap-6 mb-8 border-b border-slate-200'>\r\n          <TabLink \r\n            label=\"Available Feed\" \r\n            active={activeTab === \"available\"} \r\n            href=\"?tab=available\" \r\n          />\r\n          <TabLink \r\n            label=\"My Pickups\" \r\n            active={activeTab === \"my-pickups\"} \r\n            href=\"?tab=my-pickups\" \r\n            count={pickupCount} \r\n          />\r\n        </div>\r\n\r\n        {/* --- Food Cards Grid --- */}\r\n        <div className='grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6'>\r\n          {listings.map((item) => (\r\n            <ListingCard \r\n                key={item._id.toString()} \r\n                item={item} \r\n                isPickup={activeTab === \"my-pickups\"} \r\n            />\r\n          ))}\r\n        </div>\r\n\r\n        {listings.length === 0 && <EmptyState />}\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\n// --- Helper Components & Functions ---\r\n\r\nasync function fetchListings(tab, userId) {\r\n  const query = tab === \"available\" \r\n    ? { status: \"available\", expiryTime: { $gt: new Date() } }\r\n    : { claimedBy: userId, status: \"claimed\" };\r\n\r\n  return Listing.find(query)\r\n    .populate(\"donorId\", \"name email donorDetails\")\r\n    .sort(tab === \"available\" ? { createdAt: -1 } : { updatedAt: -1 })\r\n    .lean();\r\n}\r\n\r\nconst TabLink = ({ label, active, href, count }) => (\r\n  <Link\r\n    href={href}\r\n    className={`pb-4 px-2 text-sm font-bold transition-all relative ${\r\n      active ? \"text-emerald-600\" : \"text-slate-400 hover:text-slate-600\"\r\n    }`}\r\n  >\r\n    {label}\r\n    {active && <div className=\"absolute bottom-0 left-0 w-full h-0.5 bg-emerald-600\" />}\r\n    {count > 0 && !active && (\r\n      <span className='ml-2 bg-emerald-500 text-white px-1.5 py-0.5 rounded-full text-[10px]'>\r\n        {count}\r\n      </span>\r\n    )}\r\n  </Link>\r\n);\r\n\r\nconst ListingCard = ({ item, isPickup }) => (\r\n  <div className='group bg-white rounded-2xl shadow-sm border border-slate-100 overflow-hidden hover:border-emerald-200 transition-all'>\r\n    <div className='p-5'>\r\n      <div className='flex justify-between items-center mb-4'>\r\n        <span className='bg-slate-100 text-slate-600 text-[10px] font-bold px-2 py-1 rounded uppercase tracking-widest'>\r\n          {item.foodType}\r\n        </span>\r\n        {isPickup && (\r\n          <span className='flex items-center gap-1 text-emerald-600 text-[10px] font-bold uppercase'>\r\n            <PackageCheck size={14} /> Claimed\r\n          </span>\r\n        )}\r\n      </div>\r\n\r\n      <h3 className='text-lg font-bold text-slate-800 group-hover:text-emerald-700 transition-colors'>\r\n        {item.title}\r\n      </h3>\r\n      <p className='text-xs text-slate-400 mt-1 mb-4'>{item.quantity}</p>\r\n\r\n      <div className='space-y-2.5 bg-slate-50/50 p-3 rounded-xl mb-4 border border-slate-100'>\r\n        <div className='flex items-start gap-2 text-slate-600'>\r\n          <MapPin size={14} className='mt-0.5 text-slate-400' />\r\n          <span className='text-[11px] leading-relaxed'>{item.pickupAddress}</span>\r\n        </div>\r\n        <div className='flex items-center gap-2 text-slate-600'>\r\n          <Clock size={14} className='text-slate-400' />\r\n          <span className='text-[11px]'>\r\n            Expires: {new Date(item.expiryTime).toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' })}\r\n          </span>\r\n        </div>\r\n      </div>\r\n\r\n      {isPickup ? (\r\n        <div className='space-y-2'>\r\n          <div className='flex items-center justify-between p-2.5 bg-emerald-50/50 rounded-lg border border-emerald-100'>\r\n            <span className='text-[10px] font-black text-emerald-700 uppercase'>Contact</span>\r\n            <span className='text-xs font-bold text-emerald-900'>\r\n              {item.donorId?.donorDetails?.phoneNumber || \"No Phone\"}\r\n            </span>\r\n          </div>\r\n          <button className='w-full py-2.5 bg-slate-900 text-white text-[11px] font-bold uppercase tracking-widest rounded-xl hover:bg-slate-800 transition-colors flex items-center justify-center gap-2'>\r\n            Open in Maps <ExternalLink size={12} />\r\n          </button>\r\n        </div>\r\n      ) : (\r\n        <ClaimButton listingId={item._id.toString()} />\r\n      )}\r\n    </div>\r\n  </div>\r\n);\r\n\r\nconst EmptyState = () => (\r\n  <div \n\n// ‚úÇÔ∏è Truncated for AI (original 6397 characters)",
  "src\\app\\(shared)\\history\\page.js": "import React from \"react\";\r\nimport connectDB from \"@/lib/db\";\r\nimport Listing from \"@/models/Listing\";\r\nimport { getServerSession } from \"next-auth\";\r\nimport { authOptions } from \"@/app/api/auth/[...nextauth]/route\";\r\nimport { CheckCircle, XCircle, Package, ArrowLeft } from \"lucide-react\";\r\nimport Link from \"next/link\";\r\n\r\nexport default async function HistoryPage() {\r\n  const session = await getServerSession(authOptions);\r\n  const userId = session?.user?.id;\r\n  const role = session?.user?.role;\r\n\r\n  await connectDB();\r\n\r\n  // Fetch all listings that are NOT 'available' or 'claimed'\r\n  const filter = role === \"donor\" \r\n    ? { donorId: userId, status: { $in: [\"completed\", \"expired\"] } }\r\n    : { claimedBy: userId, status: { $in: [\"completed\"] } };\r\n\r\n  const history = await Listing.find(filter).sort({ updatedAt: -1 }).lean();\r\n\r\n  // Calculate Impact Stats\r\n  const totalSaved = history.filter(i => i.status === \"completed\").length;\r\n\r\n  return (\r\n    <div className=\"min-h-screen bg-white p-8\">\r\n      <div className=\"max-w-4xl mx-auto\">\r\n        <Link href={`/organisation`} className=\"flex items-center gap-2 text-slate-400 hover:text-emerald-600 mb-8 transition-colors\">\r\n          <ArrowLeft size={16} />\r\n          <span className=\"text-sm font-bold uppercase tracking-wider\">Back to Dashboard</span>\r\n        </Link>\r\n\r\n        <header className=\"mb-12\">\r\n          <h1 className=\"text-4xl font-black text-slate-900 mb-2\">Impact History</h1>\r\n          <p className=\"text-slate-500\">A record of every meal you've helped save.</p>\r\n        </header>\r\n\r\n        {/* --- Impact Cards --- */}\r\n        <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6 mb-12\">\r\n          <div className=\"p-6 bg-emerald-50 rounded-3xl border border-emerald-100\">\r\n            <p className=\"text-emerald-600 font-bold text-xs uppercase tracking-widest mb-1\">Total Contributions</p>\r\n            <h2 className=\"text-4xl font-black text-emerald-900\">{totalSaved} <span className=\"text-lg font-medium\">Items</span></h2>\r\n          </div>\r\n          <div className=\"p-6 bg-slate-50 rounded-3xl border border-slate-100\">\r\n            <p className=\"text-slate-400 font-bold text-xs uppercase tracking-widest mb-1\">Environmental Impact</p>\r\n            <h2 className=\"text-4xl font-black text-slate-700\">~{totalSaved * 1.5} <span className=\"text-lg font-medium\">kg saved</span></h2>\r\n          </div>\r\n        </div>\r\n\r\n        {/* --- History List --- */}\r\n        <div className=\"space-y-4\">\r\n          <h3 className=\"text-sm font-bold text-slate-400 uppercase tracking-widest mb-6\">Past Activities</h3>\r\n          \r\n          {history.length > 0 ? (\r\n            history.map((item) => (\r\n              <div key={item._id.toString()} className=\"flex items-center justify-between p-5 border border-slate-100 rounded-2xl hover:border-emerald-100 transition-all\">\r\n                <div className=\"flex items-center gap-4\">\r\n                  <div className={`p-3 rounded-xl ${item.status === 'completed' ? 'bg-emerald-50 text-emerald-600' : 'bg-red-50 text-red-600'}`}>\r\n                    {item.status === 'completed' ? <CheckCircle size={20} /> : <XCircle size={20} />}\r\n                  </div>\r\n                  <div>\r\n                    <h4 className=\"font-bold text-slate-800\">{item.title}</h4>\r\n                    <p className=\"text-xs text-slate-500\">{item.quantity} ‚Ä¢ {new Date(item.updatedAt).toLocaleDateString()}</p>\r\n                  </div>\r\n                </div>\r\n\r\n                <div className=\"text-right\">\r\n                  <span className={`text-[10px] font-bold px-2 py-1 rounded-full uppercase tracking-tighter ${\r\n                    item.status === 'completed' ? 'bg-emerald-100 text-emerald-700' : 'bg-red-100 text-red-700'\r\n                  }`}>\r\n                    {item.status}\r\n                  </span>\r\n                </div>\r\n              </div>\r\n            ))\r\n          ) : (\r\n            <div className=\"text-center py-20 border-2 border-dashed border-slate-100 rounded-3xl\">\r\n              <Package className=\"mx-auto text-slate-200 mb-4\" size={48} />\r\n              <p className=\"text-slate-400 italic\">No history recorded yet. Start donating!</p>\r\n            </div>\r\n          )}\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}",
  "src\\app\\about\\page.js": "import Footer from '@/components/Footer';\r\nimport Navbar from '@/components/Navbar';\r\nimport React from 'react';\r\n\r\nexport default function AboutPage() {\r\n  return (\r\n    <div className=\"font-sans text-gray-800 overflow-x-hidden\">\r\n      {/* Navbar */}\r\n      <Navbar/>\r\n\r\n      {/* About Hero Header */}\r\n      <section className=\"relative h-[400px] p-10 flex items-center px-6 md:px-20 text-white overflow-hidden\">\r\n        {/* Background Overlay */}\r\n        <div className=\"absolute inset-0 bg-green-900/80 z-0\"></div>\r\n        <img \r\n          src=\"https://images.unsplash.com/photo-1488521787991-ed7bbaae773c?auto=format&fit=crop&q=80\" \r\n          className=\"absolute inset-0 w-full h-full object-cover -z-10\" \r\n          alt=\"About background\"\r\n        />\r\n\r\n        <div className=\"relative flex-1 z-10\">\r\n          <h1 className=\"text-4xl md:text-5xl font-bold mb-4 leading-tight\">\r\n            Our Mission to End Hunger\r\n          </h1>\r\n          <p className=\"text-lg md:text-xl opacity-90 max-w-lg\">\r\n            Bridging the gap between surplus food and those who need it most.\r\n          </p>\r\n        </div>\r\n\r\n        <div className=\"hidden md:flex flex-1 relative justify-end z-10\">\r\n          {/* Decorative Circle */}\r\n          <div className=\"absolute -bottom-12 -right-4 w-72 h-72 bg-amber-500 rounded-full -z-10\"></div>\r\n          <img \r\n            src=\"/NABUT.png\" \r\n            alt=\"Volunteers\" \r\n            className=\"w-[300px] h-[200px] p-20 object-cover rounded-xl border-4 border-white/20 shadow-2xl\" \r\n          />\r\n        </div>\r\n      </section>\r\n\r\n      {/* Our Story Section */}\r\n      <div className=\"my-2 px-6 md:px-20 bg-white \">\r\n        <div className=\"max-w-6xl mx-auto flex flex-col md:flex-row items-center gap-12 md:gap-20\">\r\n          <div className=\"flex-1\">\r\n            <span className=\"text-amber-500 font-bold tracking-widest text-sm uppercase\">OUR STORY</span>\r\n            <h2 className=\"text-3xl md:text-4xl font-bold text-green-900 mt-2 mb-6\">How FoodLink was Born</h2>\r\n            <div className=\"space-y-4 text-gray-600 leading-relaxed text-lg\">\r\n              <p>\r\n                FoodLink started as a simple observation: millions of tons of food were being wasted daily while people in our communities were going hungry. We realized that the problem wasn't a lack of food, but a lack of <strong className=\"text-gray-900\">connection</strong>.\r\n              </p>\r\n              <p>\r\n                We built this digital bridge to make sure that excess food from restaurants, events, and homes can find its way to local NGOs and volunteers instantly.\r\n              </p>\r\n            </div>\r\n          </div>\r\n          \r\n          <div className=\"flex-1 w-full\">\r\n            <div className=\"relative\">\r\n              {/* Blue Shadow Accent from CSS */}\r\n              <img \r\n                src=\"/about.png\" \r\n                alt=\"Team working together\" \r\n                className=\"w-full rounded-3xl py-10 shadow-[20px_20px_0px_rgba(238,247,255,1)] relative z-10 border border-gray-100\"\r\n              />\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Footer */}\r\n   <Footer/>\r\n    </div>\r\n  );\r\n}",
  "src\\app\\api\\auth\\[...nextauth]\\route.js": "import NextAuth from \"next-auth\";\r\nimport CredentialsProvider from \"next-auth/providers/credentials\";\r\nimport connectDB from \"@/lib/db\";\r\nimport User from \"@/models/User\";\r\nimport bcrypt from \"bcryptjs\";\r\n\r\nexport const authOptions = {\r\n  session: {\r\n    strategy: \"jwt\",\r\n    maxAge: 30 * 24 * 60 * 60, // 30 days\r\n  },\r\n  providers: [\r\n    CredentialsProvider({\r\n      name: \"credentials\",\r\n      credentials: {},\r\n      async authorize(credentials) {\r\n        try {\r\n          await connectDB();\r\n          if (!credentials?.email || !credentials?.password) return null;\r\n\r\n          const user = await User.findOne({\r\n            email: credentials.email.toLowerCase(),\r\n          }).lean();\r\n\r\n          if (!user) return null;\r\n\r\n          const isValid = await bcrypt.compare(credentials.password, user.password);\r\n          if (!isValid) return null;\r\n\r\n          return {\r\n            id: user._id.toString(),\r\n            email: user.email,\r\n            name: user.name || null,\r\n            role: user.role,\r\n          };\r\n        } catch (err) {\r\n          console.error(\"Authorize crashed:\", err);\r\n          return null;\r\n        }\r\n      },\r\n    }),\r\n  ],\r\n  callbacks: {\r\n    async jwt({ token, user }) {\r\n      if (user) {\r\n        token.role = user.role;\r\n        token.id = user.id; // Persists ID to token\r\n      }\r\n      return token;\r\n    },\r\n    async session({ session, token }) {\r\n      if (session.user) {\r\n        session.user.role = token.role;\r\n        session.user.id = token.id; // Persists ID to session\r\n      }\r\n      return session;\r\n    },\r\n  }, // Fixed closing brace for callbacks\r\n  pages: {\r\n    signIn: \"/log-in\",\r\n    error: \"/log-in\",\r\n  },\r\n  secret: process.env.NEXTAUTH_SECRET,\r\n};\r\n\r\nconst handler = NextAuth(authOptions);\r\nexport { handler as GET, handler as POST };",
  "src\\app\\globals.css": "@import \"tailwindcss\";\n\n:root {\n  --background: #ffffff;\n  --foreground: #171717;\n}\n\n@theme inline {\n  --color-background: var(--background);\n  --color-foreground: var(--foreground);\n  --font-sans: var(--font-geist-sans);\n  --font-mono: var(--font-geist-mono);\n}\n\n@media (prefers-color-scheme: dark) {\n  :root {\n    --background: #0a0a0a;\n    --foreground: #ededed;\n  }\n}\n\nbody {\n  background: var(--background);\n  color: var(--foreground);\n  font-family: Arial, Helvetica, sans-serif;\n}\n",
  "src\\app\\impact\\layout.js": "import Footer from '@/components/Footer'\r\nimport Navbar from '@/components/Navbar'\r\nimport React from 'react'\r\n\r\nfunction layout({children}) {\r\n  return (\r\n    <>\r\n    <Navbar/>\r\n  {children}\r\n  <Footer/>\r\n    </>\r\n  )\r\n}\r\n\r\nexport default layout",
  "src\\app\\impact\\page.js": "import Footer from '@/components/Footer';\r\nimport React from 'react';\r\n\r\nexport default function ImpactPage() {\r\n  return (\r\n\r\n<>\r\n      {/* Impact Hero Section */}\r\n      <section className=\"relative h-[250px] flex flex-col justify-center px-6 md:px-20 text-white overflow-hidden\">\r\n        <div className=\"absolute inset-0 bg-green-900/90 z-0\"></div>\r\n        <img \r\n          src=\"https://images.unsplash.com/photo-1488521787991-ed7bbaae773c?auto=format&fit=crop&q=80\" \r\n          className=\"absolute inset-0 w-full h-full object-cover -z-10\" \r\n          alt=\"Impact background\"\r\n          />\r\n        <div className=\"relative z-10 max-w-4xl\">\r\n          <h1 className=\"text-4xl md:text-5xl font-bold mb-4\">Small Actions, Big Results</h1>\r\n          <p className=\"text-lg md:text-xl opacity-90\">Tracking our progress in the fight against hunger and food waste.</p>\r\n        </div>\r\n      </section>\r\n\r\n      {/* Impact Stats Grid */}\r\n      <section className=\"py-20 px-6 bg-white\">\r\n        <div className=\"max-w-6xl mx-auto\">\r\n          <div className=\"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6\">\r\n            {/* Impact Card 1 */}\r\n            <div className=\"bg-sky-50 p-10 rounded-2xl text-center transition-transform hover:-translate-y-2 border-b-4 border-amber-500 shadow-sm\">\r\n              <div className=\"text-4xl mb-4\">üç±</div>\r\n              <h3 className=\"text-3xl font-bold text-green-900 mb-2\">15,000+</h3>\r\n              <p className=\"text-gray-600 font-semibold\">Total Meals Redirected</p>\r\n            </div>\r\n            {/* Impact Card 2 */}\r\n            <div className=\"bg-sky-50 p-10 rounded-2xl text-center transition-transform hover:-translate-y-2 border-b-4 border-amber-500 shadow-sm\">\r\n              <div className=\"text-4xl mb-4\">üåç</div>\r\n              <h3 className=\"text-3xl font-bold text-green-900 mb-2\">4.5 Tons</h3>\r\n              <p className=\"text-gray-600 font-semibold\">CO2 Emissions Prevented</p>\r\n            </div>\r\n            {/* Impact Card 3 */}\r\n            <div className=\"bg-sky-50 p-10 rounded-2xl text-center transition-transform hover:-translate-y-2 border-b-4 border-amber-500 shadow-sm\">\r\n              <div className=\"text-4xl mb-4\">üè¢</div>\r\n              <h3 className=\"text-3xl font-bold text-green-900 mb-2\">120+</h3>\r\n              <p className=\"text-gray-600 font-semibold\">Partner Restaurants</p>\r\n            </div>\r\n            {/* Impact Card 4 */}\r\n            <div className=\"bg-sky-50 p-10 rounded-2xl text-center transition-transform hover:-translate-y-2 border-b-4 border-amber-500 shadow-sm\">\r\n              <div className=\"text-4xl mb-4\">ü§ù</div>\r\n              <h3 className=\"text-3xl font-bold text-green-900 mb-2\">2,000+</h3>\r\n              <p className=\"text-gray-600 font-semibold\">Active Volunteers</p>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </section>\r\n\r\n      {/* Testimonials Section */}\r\n      <section className=\"bg-gray-50 py-20 px-6 text-center\">\r\n        <div className=\"max-w-5xl mx-auto\">\r\n          <h2 className=\"text-3xl md:text-4xl font-bold text-green-900 mb-12\">Voices from the Community</h2>\r\n          <div className=\"grid grid-cols-1 md:grid-cols-2 gap-8\">\r\n            <div className=\"bg-white p-8 rounded-2xl shadow-sm italic text-gray-700 flex flex-col justify-between\">\r\n              <p className=\"text-lg leading-relaxed mb-6\">\"FoodLink has transformed how we manage surplus at our hotel. Instead of waste, we see smiles.\"</p>\r\n              <span className=\"not-italic font-bold text-green-900 block\">- Hotel Manager, Goa</span>\r\n            </div>\r\n            <div className=\"bg-white p-8 rounded-2xl shadow-sm italic text-gray-700 flex flex-col justify-between\">\r\n              <p className=\"text-lg leading-relaxed mb-6\">\"The real-time alerts make it so easy for our NGO to pick up fresh food for the children we support.\"</p>\r\n              <span className=\"not-italic font-bold text-green-900 block\">- NGO Director</span>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </section>\r\n      </>\r\n  );\r\n}",
  "src\\app\\knowhow\\page.js": "import Footer from '@/components/Footer';\r\nimport Navbar from '@/components/Navbar';\r\nimport React from 'react';\r\n\r\nexport default function HowItWorks() {\r\n  return (\r\n    <div className=\"font-sans text-gray-800\">\r\n      {/* Navbar */}\r\n     <Navbar/>\r\n\r\n      {/* Hero Header */}\r\n      <section className=\"relative h-[250px] flex flex-col justify-center px-6 md:px-20 text-white overflow-hidden\">\r\n        <div className=\"absolute inset-0 bg-green-900/90 z-0\"></div>\r\n        <img \r\n          src=\"https://images.unsplash.com/photo-1488521787991-ed7bbaae773c?auto=format&fit=crop&q=80\" \r\n          className=\"absolute inset-0 w-full h-full object-cover -z-10\" \r\n          alt=\"How it works background\"\r\n        />\r\n        <div className=\"relative z-10 max-w-4xl\">\r\n          <h1 className=\"text-4xl md:text-5xl font-bold mb-4\">How FoodLink Works</h1>\r\n          <p className=\"text-lg md:text-xl opacity-90\">Connecting surplus food to those in need in four simple steps.</p>\r\n        </div>\r\n      </section>\r\n\r\n      {/* Workflow Diagram Section */}\r\n      <section className=\"py-20 px-6 bg-white\">\r\n        <div className=\"max-w-6xl mx-auto text-center\">\r\n          <h2 className=\"text-3xl md:text-4xl font-bold text-green-900 mb-16\">The Donation Workflow</h2>\r\n          \r\n          <div className=\"flex flex-col md:flex-row items-center justify-between gap-4 md:gap-2\">\r\n            {/* Step 1 */}\r\n            <div className=\"flex-1 p-5 relative group\">\r\n              <div className=\"bg-amber-500 text-white w-8 h-8 rounded-full flex items-center justify-center mx-auto mb-4 font-bold\">1</div>\r\n              <div className=\"text-5xl mb-4\">üè™</div>\r\n              <h3 className=\"text-green-900 font-bold text-xl mb-3\">Donors List Food</h3>\r\n              <p className=\"text-gray-600 text-sm leading-relaxed\">Restaurants or households post details like quantity and expiry.</p>\r\n            </div>\r\n\r\n            <div className=\"text-amber-500 text-2xl font-bold rotate-90 md:rotate-0\">‚ûú</div>\r\n\r\n            {/* Step 2 */}\r\n            <div className=\"flex-1 p-5 relative group\">\r\n              <div className=\"bg-amber-500 text-white w-8 h-8 rounded-full flex items-center justify-center mx-auto mb-4 font-bold\">2</div>\r\n              <div className=\"text-5xl mb-4\">üì±</div>\r\n              <h3 className=\"text-green-900 font-bold text-xl mb-3\">NGOs Notified</h3>\r\n              <p className=\"text-gray-600 text-sm leading-relaxed\">Nearby verified NGOs receive a real-time alert about the donation.</p>\r\n            </div>\r\n\r\n            <div className=\"text-amber-500 text-2xl font-bold rotate-90 md:rotate-0\">‚ûú</div>\r\n\r\n            {/* Step 3 */}\r\n            <div className=\"flex-1 p-5 relative group\">\r\n              <div className=\"bg-amber-500 text-white w-8 h-8 rounded-full flex items-center justify-center mx-auto mb-4 font-bold\">3</div>\r\n              <div className=\"text-5xl mb-4\">üöö</div>\r\n              <h3 className=\"text-green-900 font-bold text-xl mb-3\">Pickup Arranged</h3>\r\n              <p className=\"text-gray-600 text-sm leading-relaxed\">A volunteer or NGO staff picks up the food at the location.</p>\r\n            </div>\r\n\r\n            <div className=\"text-amber-500 text-2xl font-bold rotate-90 md:rotate-0\">‚ûú</div>\r\n\r\n            {/* Step 4 */}\r\n            <div className=\"flex-1 p-5 relative group\">\r\n              <div className=\"bg-amber-500 text-white w-8 h-8 rounded-full flex items-center justify-center mx-auto mb-4 font-bold\">4</div>\r\n              <div className=\"text-5xl mb-4\">‚ù§Ô∏è</div>\r\n              <h3 className=\"text-green-900 font-bold text-xl mb-3\">Food Delivered</h3>\r\n              <p className=\"text-gray-600 text-sm leading-relaxed\">The food is quality-checked and served to the community.</p>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </section>\r\n\r\n      {/* Roles Section */}\r\n      <section className=\"bg-sky-50 py-16 px-6\">\r\n        <div className=\"max-w-4xl mx-auto\">\r\n          <div className=\"grid grid-cols-1 md:grid-cols-2 gap-10\">\r\n            {/* For Donors */}\r\n            <div className=\"bg-white p-8 rounded-2xl shadow-sm border-t-8 border-green-900\">\r\n              <h3 className=\"text-green-900 text-2xl font-bold mb-4\">For Donors</h3>\r\n              <p className=\"text-gray-600 leading-relaxed\">\r\n                Reduce your waste footprint. Simply take a photo, list the food type, and set a pickup window. We handle the rest.\r\n              </p>\r\n            </div>\r\n            {/* For NGOs */}\r\n            <div className=\"bg-white p-8 rounded-2xl shadow-sm border-t-8 border-green-900\">\r\n              <h3 className=\"text-green-900 text-2xl font-bold mb-4\">For NGOs</h3>\r\n              <p className=\"text-gray-600 leading-relaxed\">\r\n                Access a steady stream of donations. Our dashboard helps you manage multiple pickups and track impact.\r\n              </p>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </section>\r\n\r\n      {/* Footer */}\r\n   <Footer/>\r\n    </div>\r\n  );\r\n}",
  "src\\app\\layout.js": "import { Geist, Geist_Mono } from \"next/font/google\";\nimport \"./globals.css\";\nimport Providers from \"@/components/Providers\";\n\nconst geistSans = Geist({\n  variable: \"--font-geist-sans\",\n  subsets: [\"latin\"],\n});\n\nconst geistMono = Geist_Mono({\n  variable: \"--font-geist-mono\",\n  subsets: [\"latin\"],\n});\n\nexport const metadata = {\n  title: \"Create Next App\",\n  description: \"Generated by create next app\",\n};\n\nexport default function RootLayout({ children }) {\n  return (\n    <html lang=\"en\">\n      <body\n        className={`${geistSans.variable} ${geistMono.variable} antialiased`}\n      >\n<Providers>\n        {children}\n</Providers>\n      </body>\n    </html>\n  );\n}\n",
  "src\\app\\page.js": "\"use client\";\nimport Footer from '@/components/Footer';\nimport Navbar from '@/components/Navbar';\nimport Link from 'next/link';\nimport React, { useState } from 'react';\n\nexport default function FoodLinkLanding() {\n  const [isExpanded, setIsExpanded] = useState(false);\n\n  return (\n    <div className=\"font-sans text-gray-800 overflow-x-hidden\">\n      {/* Navbar */}\n     <Navbar/>\n\n      {/* Hero Section */}\n      <section className=\"relative h-[500px] flex items-center px-6 md:px-20 text-white overflow-hidden\">\n        {/* Background Overlay */}\n        <div className=\"absolute inset-0 bg-green-900/90 z-0\"></div>\n        <img \n          src=\"https://images.unsplash.com/photo-1488521787991-ed7bbaae773c?auto=format&fit=crop&q=80\" \n          className=\"absolute inset-0 w-full h-full object-cover -z-10\" \n          alt=\"Hero background\"\n        />\n\n        <div className=\"relative flex-1 z-10\">\n          <h1 className=\"text-4xl md:text-5xl font-bold mb-6 leading-tight\">\n            Share Extra Food<br />Spread Extra Smiles :)\n          </h1>\n          <p className=\"text-lg md:text-xl mb-8 opacity-90 max-w-lg\">\n            Connect surplus food with NGOs and reduce hunger, one meal at a time\n          </p>\n          <Link href={'/register'}>\n          <button className=\"bg-amber-500 text-green-950 py-3 px-10 rounded-full font-bold hover:bg-amber-400 transition-transform active:scale-95\">\n            Register\n          </button>\n          </Link>\n        </div>\n        \n        <div className=\"hidden md:flex flex-1 relative justify-end z-10\">\n          {/* Decorative Circle */}\n          <div className=\"absolute -bottom-12 -right-4 w-72 h-72 bg-amber-500 rounded-full -z-10\"></div>\n          <img \n            src=\"/o.png\" \n            alt=\"Volunteers\" \n            className=\"w-[400px] h-[300px] object-cover rounded-xl border-4 border-white/20 shadow-2xl\" \n          />\n        </div>\n      </section>\n\n      {/* Stats Section */}\n      <section className=\"grid grid-cols-1 md:grid-cols-3 gap-4 py-16 px-6 md:px-20 text-center bg-white\">\n        <div className=\"py-6 border rounded-xl border-emerald-400\">\n          <h2 className=\"text-4xl font-bold text-green-900 mb-2\">500+</h2>\n          <p className=\"text-gray-400 text-xs tracking-[0.2em] font-bold\">MEALS DELIVERED</p>\n        </div>\n        <div className=\"py-6 border rounded-xl border-emerald-400\">\n          <h2 className=\"text-4xl font-bold text-green-900 mb-2\">45</h2>\n          <p className=\"text-gray-400 text-xs tracking-[0.2em] font-bold\">PARTNERED NGOs</p>\n        </div>\n        <div className=\"py-6 border rounded-xl border-emerald-400\">\n          <h2 className=\"text-4xl font-bold text-green-900 mb-2\">1.2 Tons</h2>\n          <p className=\"text-gray-400 text-xs tracking-[0.2em] font-bold\">WASTE PREVENTED</p>\n        </div>\n      </section>\n\n      {/* About Section */}\n      <section className=\"bg-sky-50 py-20 px-6\">\n        <div className=\"max-w-4xl mx-auto\">\n          <h2 className=\"text-4xl md:text-5xl font-bold text-blue-900 mb-8\">The FoodLink Foundation</h2>\n          <p className=\"text-lg text-gray-600 leading-relaxed mb-6\">\n            <strong className=\"text-gray-900\">FoodLink</strong> is a web-based digital platform designed to reduce food wastage and fight hunger by connecting surplus food providers with NGOs and volunteers in real time.\n          </p>\n\n          <div className={`${isExpanded ? 'block animate-fadeIn' : 'hidden'}`}>\n            <p className=\"text-lg text-gray-600 leading-relaxed mb-6\">\n              The platform enables donors such as restaurants, event organizers, and households to list unused food by providing essential details. NGOs can view nearby food donations, accept available listings, and coordinate timely pickups through volunteers.\n            </p>\n            <p className=\"text-lg text-gray-600 leading-relaxed mb-6\">\n              FoodLink also aims to provide meals to children from communities with local food waste. We aim to support every individual and fight hunger together.\n            </p>\n    \n            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-10 my-10\">\n              <div className=\"flex gap-4\">\n                <div className=\"w-1.5 bg-green-500 rounded-full shrink-0\"></div>\n                <div>\n                  <h3 className=\"text-green-700 text-2xl font-bold mb-2\">Our Vision</h3>\n                  <p className=\"text-gray-600\">No child shall go hungry. Ending the cycle of poverty through nutrition.</p>\n                </div>\n              </div>\n    \n              <div className=\"flex gap-4\">\n                <div className=\"w-1.5 bg-green-500 rounded-full shrink-0\"></div>\n                <div>\n                  <h3 className=\"text-green-700 text-2xl font-bold mb-2\">Our Mission</h3>\n                  <p className=\"text-gray-600\">Serving 1 million meals and managing food waste by 2026.</p>\n                </div>\n              </div>\n            </div>\n          </div>\n          \n          <button \n            onClick={() => setIsExpanded(!isExpanded)}\n            className=\"bg-blue-600 text-white py-3 px-10 rounded-full text-base font-semibold hover:bg-blue-800 transition-all shadow-md hover:-translate-y-1 active:translate-y-0 mt-4\"\n          >\n            {isExpanded ? \"Read Less\" : \"Read More\"}\n          </button>\n        </div>\n      </section>\n\n      {/* Footer */}\n      <Footer/>\n    </div>\n  );\n}",
  "src\\app\\test-session\\page.js": "\"use client\";\r\nimport { useSession } from \"next-auth/react\";\r\n\r\nexport default function DebugSession() {\r\n  const { data: session, status } = useSession();\r\n\r\n  if (status === \"loading\") return <div>Loading session...</div>;\r\n\r\n  return (\r\n    <div className=\"p-8\">\r\n      <h1>Session Debug</h1>\r\n      <pre className=\"bg-gray-100 p-4 rounded overflow-auto\">\r\n        {JSON.stringify({ status, session }, null, 2)}\r\n      </pre>\r\n    </div>\r\n  );\r\n}",
  "src\\components\\Footer.js": "import React from 'react'\r\n\r\nfunction Footer() {\r\n  return (\r\n   <>\r\n     {/* --- Footer --- */}\r\n      <footer className=\"bg-gray-50 pt-10 pb-5 border-t border-gray-200\">\r\n        <div className=\"max-w-6xl mx-auto grid grid-cols-1 md:grid-cols-4 gap-12 px-6\">\r\n          <div className=\"md:col-span-2\">\r\n            <h3 className=\"text-green-900 text-2xl font-bold mb-5\">FoodLink</h3>\r\n            <p className=\"text-gray-600 leading-relaxed max-w-sm\">\r\n              Making sure no meal goes to waste. We connect donors with those in need to build a hunger-free world.\r\n            </p>\r\n          </div>\r\n    \r\n          <div>\r\n            <h4 className=\"text-green-900 text-lg font-bold mb-6\">Quick Links</h4>\r\n            <ul className=\"space-y-3\">\r\n              <li><a href=\"/home\" className=\"text-gray-600 hover:text-amber-600 transition-colors\">Home</a></li>\r\n              <li><a href=\"/about\" className=\"text-gray-600 hover:text-amber-600 transition-colors\">About Us</a></li>\r\n            </ul>\r\n          </div>\r\n    \r\n          <div>\r\n            <h4 className=\"text-green-900 text-lg font-bold mb-6\">Contact Us</h4>\r\n            <div className=\"text-gray-600 space-y-2 text-sm\">\r\n              <p>Email: hello@foodlink.org</p>\r\n              <p>Phone: +1 (555) 000-1234</p>\r\n              <p>Location: New Goa, Goa</p>\r\n            </div>\r\n          </div>\r\n        </div>\r\n        \r\n        <div className=\"text-center mt-16 border-t border-gray-200 text-gray-400 text-sm\">\r\n          <p>&copy; 2026 FoodLink Organization. All rights reserved.</p>\r\n        </div>\r\n      </footer>\r\n   </>\r\n  )\r\n}\r\n\r\nexport default Footer",
  "src\\components\\Hero.js": "import React from 'react'\r\n\r\nfunction Hero() {\r\n  return (\r\n    <>\r\n    {/* --- Hero Section --- */}\r\n      <header className=\"px-8 py-20 bg-emerald-600 text-white text-center\">\r\n        <div className=\"max-w-4xl mx-auto\">\r\n          <h1 className=\"text-5xl font-extrabold mb-6 leading-tight\">\r\n            Connecting Surplus Food to Those in Need\r\n          </h1>\r\n          <p className=\"text-xl mb-10 opacity-90\">\r\n            Real-time food redistribution to reduce waste and fight hunger in our community.\r\n          </p>\r\n          <div className=\"flex flex-wrap justify-center gap-4\">\r\n            <button className=\"px-8 py-4 bg-white text-emerald-600 text-lg font-bold rounded-xl hover:bg-slate-100 transition shadow-lg\">\r\n              NGO: Find Food Nearby\r\n            </button>\r\n            <button className=\"px-8 py-4 bg-emerald-800 text-white text-lg font-bold rounded-xl hover:bg-emerald-900 transition shadow-lg\">\r\n              Donor: List Surplus Food\r\n            </button>\r\n          </div>\r\n        </div>\r\n      </header>\r\n    </>\r\n  )\r\n}\r\n\r\nexport default Hero",
  "src\\components\\Navbar.js": "import Link from 'next/link'\r\nimport React from 'react'\r\n\r\nfunction Navbar() {\r\n  return (\r\n    <>\r\n    {/* --- Navigation --- */}\r\n       <header className=\"flex justify-between items-center py-3 px-6 md:px-20 bg-white\">\r\n        <div className=\"flex items-center gap-3\">\r\n            <img src=\"/logo.jpeg\" alt=\"Logo\" style={{width:37}} />\r\n          <span className=\"text-2xl font-bold text-green-900\">FoodLink</span>\r\n        </div>\r\n        <nav>\r\n          <ul className=\"hidden md:flex items-center gap-8 list-none\">\r\n            <li><a href=\"/\" className=\"text-gray-700 font-semibold hover:text-amber-500 transition-colors\">Home</a></li>\r\n            <li><a href=\"/impact\" className=\"text-gray-700 font-semibold hover:text-amber-500 transition-colors\">Our Impact</a></li>\r\n            <li><a href=\"/knowhow\" className=\"text-gray-700 font-semibold hover:text-amber-500 transition-colors\">How it Works</a></li>\r\n            <li><a href=\"/about\" className=\"text-gray-700 font-semibold hover:text-amber-500 transition-colors\">About Us</a></li>\r\n            <li>\r\n              <Link href={'/log-in'}>\r\n              <button className=\"bg-amber-500 text-white px-6 py-2.5 rounded-full font-bold hover:bg-amber-600 transition-all\">\r\n                Sign-in\r\n              </button>\r\n              </Link>\r\n            </li>\r\n          </ul>\r\n        </nav>\r\n      </header>\r\n            </>\r\n  )\r\n}\r\n\r\nexport default Navbar",
  "src\\components\\Providers.js": "\"use client\";\r\nimport { SessionProvider } from \"next-auth/react\";\r\n\r\nexport default function Providers({ children }) {\r\n  return <SessionProvider>{children}</SessionProvider>;\r\n}",
  "src\\features\\auth\\actions.js": "\"use server\";\r\nimport connectDB from \"@/lib/db\";\r\nimport User from \"@/models/User\";\r\nimport bcrypt from \"bcryptjs\";\r\n\r\nexport async function registerUser(payload) {\r\n  try {\r\n    await connectDB();\r\n    const { email, password, role, ...details } = payload;\r\n    const normalizedEmail = email.toLowerCase();\r\n\r\n    const existingUser = await User.findOne({ email: normalizedEmail });\r\n    if (existingUser) return { error: \"User already exists\" };\r\n\r\n    const salt = await bcrypt.genSalt(12);\r\n    const hashedPassword = await bcrypt.hash(password, salt);\r\n\r\n    const userData = {\r\n      name: role === 'ngo' ? details.ngoName : details.name,\r\n      email: normalizedEmail,\r\n      password: hashedPassword,\r\n      role,\r\n      status: \"pending\", // Default to pending for verification\r\n    };\r\n\r\n    if (role === 'ngo') {\r\n      userData.ngoDetails = details;\r\n    } else {\r\n      userData.donorDetails = details;\r\n    }\r\n\r\n    const newUser = new User(userData);\r\n    await newUser.save();\r\n    return { success: true };\r\n  } catch (error) {\r\n    console.error(\"Registration Error:\", error);\r\n    return { error: \"Registration failed. Check all fields.\" };\r\n  }\r\n}\r\n\r\n\r\n\r\n\r\n\r\n",
  "src\\features\\donor\\actions.js": "\"use server\";\r\n\r\nimport connectDB from \"@/lib/db\";\r\nimport Listing from \"@/models/Listing\";\r\nimport { getServerSession } from \"next-auth\";\r\nimport { authOptions } from \"@/app/api/auth/[...nextauth]/route\";\r\nimport { revalidatePath } from \"next/cache\";\r\n\r\nexport async function createListing(prevState, formData) {\r\n  const session = await getServerSession(authOptions);\r\n  if (!session) return { error: \"Unauthorized\" };\r\n\r\n  await connectDB();\r\n\r\n  // 1. Extract exactly what the form sends\r\n  const title = formData.get(\"title\");\r\n  const foodType = formData.get(\"foodType\");\r\n  const quantity = formData.get(\"quantity\");\r\n  const expiryTime = formData.get(\"expiryTime\");\r\n  const pickupAddress = formData.get(\"pickupAddress\"); // Ensure this matches name=\"pickupAddress\" in form\r\n\r\n  // 2. Comprehensive Validation Check\r\n  if (!title || !foodType || !quantity || !expiryTime || !pickupAddress) {\r\n    return { error: \"Missing fields. Please check Title, Type, Quantity, Expiry, and Address.\" };\r\n  }\r\n\r\n  try {\r\n    await Listing.create({\r\n      donorId: session.user.id,\r\n      title,\r\n      description: title, // Using title as description since form doesn't have a desc field\r\n      foodType,\r\n      quantity,\r\n      pickupAddress,\r\n      expiryTime: new Date(expiryTime),\r\n      status: \"available\",\r\n    });\r\n\r\n    revalidatePath(\"/donor\");\r\n    return { success: \"Donation posted successfully!\" };\r\n  } catch (error) {\r\n    // 3. Log the ACTUAL error to your console so you can see the field name failing\r\n    console.error(\"MONGODB_SAVE_ERROR:\", error.message);\r\n    return { error: `Database Error: ${error.message}` };\r\n  }\r\n}\r\n\r\nexport async function completeListing(listingId) {\r\n  const session = await getServerSession(authOptions);\r\n  if (!session || session.user.role !== \"donor\") return { error: \"Unauthorized\" };\r\n\r\n  await connectDB();\r\n\r\n  try {\r\n    const updated = await Listing.findOneAndUpdate(\r\n      { _id: listingId, donorId: session.user.id, status: \"claimed\" },\r\n      { $set: { status: \"completed\" } },\r\n      { new: true }\r\n    );\r\n\r\n    if (!updated) return { error: \"Could not update. Item may not be claimed yet.\" };\r\n\r\n    // This clears the cache for both dashboards instantly\r\n    revalidatePath(\"/donor\");\r\n    revalidatePath(\"/organisation\");\r\n\r\n    return { success: true };\r\n  } catch (error) {\r\n    return { error: \"Database error.\" };\r\n  }\r\n}\r\nexport async function completeTransaction(listingId) {\r\n  try {\r\n    await connectDB();\r\n\r\n    // 1. Update status to 'completed'\r\n    // This effectively \"removes\" it from active views because active views \r\n    // should filter for status: 'available' or 'pending'\r\n    const updatedListing = await Listing.findByIdAndUpdate(\r\n      listingId,\r\n      { \r\n        status: 'completed',\r\n        completedAt: new Date() \r\n      },\r\n      { new: true }\r\n    );\r\n\r\n    if (!updatedListing) {\r\n      return { success: false, error: \"Listing not found\" };\r\n    }\r\n\r\n    // 2. Clear cache for Donor and NGO dashboards\r\n    revalidatePath(\"/donor\");\r\n    revalidatePath(\"/ngo\");\r\n\r\n    return { success: true };\r\n  } catch (error) {\r\n    console.error(\"Transaction Completion Error:\", error);\r\n    return { success: false, error: \"Internal Server Error\" };\r\n  }\r\n}",
  "src\\features\\donor\\components\\DonationForm.js": "\"use client\";\r\n\r\nimport { useActionState } from \"react\";\r\nimport { createListing } from \"@/features/donor/actions\";\r\n\r\nexport default function DonationForm() {\r\n  // state will hold the return value from our server action (success or error)\r\n  const [state, formAction, isPending] = useActionState(createListing, null);\r\n\r\n  return (\r\n    <div className=\"max-w-2xl mx-auto p-6 bg-white rounded-xl shadow-md border border-gray-100\">\r\n      <h2 className=\"text-2xl font-bold mb-6 text-gray-800\">Post Surplus Food</h2>\r\n      \r\n    <form \r\n      key={state?.success ? \"success\" : \"reset\"} \r\n      action={formAction} \r\n      className=\"space-y-4\"\r\n    >\r\n        {/* Title */}\r\n        <div>\r\n          <label className=\"block text-sm font-medium text-gray-700\">Item Name</label>\r\n          <input\r\n            name=\"title\"\r\n            placeholder=\"e.g., Dal Tadka and Rice\"\r\n            className=\"w-full p-2 mt-1 border rounded-lg focus:ring-2 focus:ring-green-500 outline-none\"\r\n            required\r\n          />\r\n        </div>\r\n\r\n        {/* Type & Quantity */}\r\n        <div className=\"grid grid-cols-2 gap-4\">\r\n          <div>\r\n            <label className=\"block text-sm font-medium text-gray-700\">Food Type</label>\r\n            <select name=\"foodType\" className=\"w-full p-2 mt-1 border rounded-lg bg-white\">\r\n              <option value=\"Cooked\">Cooked Meal</option>\r\n              <option value=\"Raw\">Raw Materials</option>\r\n              <option value=\"Packaged\">Packaged/Canned</option>\r\n            </select>\r\n          </div>\r\n          <div>\r\n            <label className=\"block text-sm font-medium text-gray-700\">Quantity</label>\r\n            <input\r\n              name=\"quantity\"\r\n              placeholder=\"e.g., 50 plates / 10kg\"\r\n              className=\"w-full p-2 mt-1 border rounded-lg\"\r\n              required\r\n            />\r\n          </div>\r\n        </div>\r\n\r\n        {/* Expiry Time - Crucial for Real-Time logic */}\r\n        <div>\r\n          <label className=\"block text-sm font-medium text-gray-700\">Best Before (Expiry Time)</label>\r\n          <input\r\n            type=\"datetime-local\"\r\n            name=\"expiryTime\"\r\n            className=\"w-full p-2 mt-1 border rounded-lg\"\r\n            required\r\n          />\r\n          <p className=\"text-xs text-gray-500 mt-1\">When should this be removed from the list?</p>\r\n        </div>\r\n\r\n        {/* Pickup Address */}\r\n        <div>\r\n          <label className=\"block text-sm font-medium text-gray-700\">Pickup Location</label>\r\n          <textarea\r\n            name=\"pickupAddress\"\r\n            rows=\"2\"\r\n            placeholder=\"Enter the full address for pickup\"\r\n            className=\"w-full p-2 mt-1 border rounded-lg\"\r\n            required\r\n          ></textarea>\r\n        </div>\r\n\r\n        {/* Feedback Messages */}\r\n        {state?.error && <p className=\"text-red-500 text-sm bg-red-50 p-2 rounded\">{state.error}</p>}\r\n        {state?.success && <p className=\"text-green-600 text-sm bg-green-50 p-2 rounded\">{state.success}</p>}\r\n\r\n        {/* Submit Button */}\r\n        <button\r\n          type=\"submit\"\r\n          disabled={isPending}\r\n          className={`w-full py-3 rounded-lg font-semibold text-white transition-all ${\r\n            isPending ? \"bg-gray-400\" : \"bg-green-600 hover:bg-green-700 shadow-lg\"\r\n          }`}\r\n        >\r\n          {isPending ? \"Posting...\" : \"Broadcast to Nearby NGOs\"}\r\n        </button>\r\n      </form>\r\n    </div>\r\n  );\r\n}",
  "src\\features\\donor\\components\\HandoverButton.js": "\"use client\";\r\n\r\nimport { useTransition } from \"react\";\r\nimport { completeListing } from \"@/features/donor/actions\";\r\n\r\nexport default function HandoverButton({ listingId }) {\r\n  const [isPending, startTransition] = useTransition();\r\n\r\n  const handleComplete = async () => {\r\n    if (confirm(\"Has the NGO successfully collected this food?\")) {\r\n      startTransition(async () => {\r\n        const result = await completeListing(listingId);\r\n        if (result.error) alert(result.error);\r\n      });\r\n    }\r\n  };\r\n\r\n  return (\r\n    <button\r\n      onClick={handleComplete}\r\n      disabled={isPending}\r\n      className={`w-full mt-4 py-2 rounded-lg text-xs font-bold transition-all ${\r\n        isPending \r\n          ? \"bg-slate-100 text-slate-400\" \r\n          : \"bg-emerald-600 text-white hover:bg-emerald-700 shadow-md\"\r\n      }`}\r\n    >\r\n      {isPending ? \"Updating...\" : \"Confirm Collection\"}\r\n    </button>\r\n  );\r\n}",
  "src\\features\\donor\\components\\NgoCards.js": "import React from \"react\";\r\nimport { MapPin, Users, ArrowUpRight, CheckCircle2 } from \"lucide-react\";\r\n\r\nconst NGOCard = ({ ngo }) => {\r\n  const { ngoDetails } = ngo;\r\n\r\n  return (\r\n    <div className='group relative flex flex-col'>\r\n      {/* The main card container */}\r\n      <div className='bg-white border rounded-2xl p-5 border-emerald-600 hover:shadow-[0_20px_40px_-15px_rgba(0,0,0,0.05)] transition-all duration-500'>\r\n        <div className='flex justify-between items-start mb-6'>\r\n          <div className='flex items-center gap-3'>\r\n            <div className='h-10 w-10 rounded-full bg-slate-50 flex items-center justify-center group-hover:bg-emerald-50 transition-colors'>\r\n              <span className='text-xs font-bold text-slate-400 group-hover:text-emerald-600'>\r\n                {ngoDetails.ngoName?.substring(0, 2).toUpperCase()}\r\n              </span>\r\n            </div>\r\n            <div>\r\n              <div className='flex items-center gap-1.5'>\r\n                <h3 className='font-bold text-slate-900 leading-none'>\r\n                  {ngoDetails.ngoName}\r\n                </h3>\r\n                <CheckCircle2 size={14} className='text-emerald-500' />\r\n              </div>\r\n              <p className='text-[10px] text-slate-400 font-bold uppercase tracking-tighter mt-1'>\r\n                {ngoDetails.registrationType}\r\n              </p>\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        <div className='space-y-4 mb-6'>\r\n          <div className='flex items-center gap-2.5 text-slate-500'>\r\n            <MapPin size={14} className='text-slate-300' />\r\n            <span className='text-xs font-medium truncate'>\r\n              {ngoDetails.address}\r\n            </span>\r\n          </div>\r\n          <div className='flex items-center gap-2.5 text-slate-500'>\r\n            <Users size={14} className='text-slate-300' />\r\n            <span className='text-xs font-medium'>\r\n              Supports {ngoDetails.beneficiaryCapacity} lives daily\r\n            </span>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Decorative background element for minimal depth */}\r\n      <div className='absolute inset-0 bg-emerald-600 rounded-2xl -z-10 translate-y-1 opacity-0 group-hover:opacity-10 group-hover:translate-y-2 transition-all duration-500'></div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default NGOCard;\r\n",
  "src\\features\\donor\\components\\SearchNGOs.js": "\"use client\";\r\n\r\nimport { Search } from 'lucide-react';\r\nimport { useRouter, useSearchParams } from 'next/navigation';\r\nimport { useTransition } from 'react';\r\n\r\nexport default function SearchNGOs() {\r\n  const router = useRouter();\r\n  const searchParams = useSearchParams();\r\n  const [isPending, startTransition] = useTransition();\r\n\r\n  function handleSearch(term) {\r\n    const params = new URLSearchParams(searchParams);\r\n    if (term) {\r\n      params.set('query', term);\r\n    } else {\r\n      params.delete('query');\r\n    }\r\n\r\n    // startTransition keeps the UI responsive while the server re-filters the data\r\n    startTransition(() => {\r\n      router.replace(`/donor?${params.toString()}`);\r\n    });\r\n  }\r\n\r\n  return (\r\n    <div className=\"relative group w-full md:w-80\">\r\n      <Search \r\n        className={`absolute left-3 top-1/2 -translate-y-1/2 transition-colors ${\r\n          isPending ? \"text-emerald-500 animate-pulse\" : \"text-slate-400 group-focus-within:text-emerald-600\"\r\n        }`} \r\n        size={16} \r\n      />\r\n      <input \r\n        type=\"text\" \r\n        defaultValue={searchParams.get('query')?.toString()}\r\n        onChange={(e) => handleSearch(e.target.value)}\r\n        placeholder=\"Find an NGO...\" \r\n        className=\"pl-10 pr-4 py-2 bg-slate-100/50 border-transparent border focus:bg-white focus:border-emerald-500 rounded-full text-sm w-full transition-all outline-none\"\r\n      />\r\n    </div>\r\n  );\r\n}",
  "src\\features\\organisation\\actions.js": "\"use server\";\r\n\r\nimport connectDB from \"@/lib/db\";\r\nimport Listing from \"@/models/Listing\";\r\nimport { getServerSession } from \"next-auth\";\r\nimport { authOptions } from \"@/app/api/auth/[...nextauth]/route\";\r\nimport { revalidatePath } from \"next/cache\";\r\n\r\nexport async function claimListing(listingId) {\r\n  const session = await getServerSession(authOptions);\r\n\r\n  // 1. Security Check\r\n  if (!session || session.user.role !== \"ngo\") {\r\n    return { error: \"Only verified NGOs can claim food.\" };\r\n  }\r\n\r\n  await connectDB();\r\n\r\n  try {\r\n    // 2. Atomic Update\r\n    // We search for the ID AND ensure it is still \"available\" \r\n    // This prevents \"Double Claiming\"\r\n    const updatedListing = await Listing.findOneAndUpdate(\r\n      { \r\n        _id: listingId, \r\n        status: \"available\" \r\n      },\r\n      { \r\n        $set: { \r\n          status: \"claimed\", \r\n          claimedBy: session.user.id \r\n        } \r\n      },\r\n      { new: true } // returns the updated document\r\n    );\r\n\r\n    if (!updatedListing) {\r\n      return { error: \"Too late! This food was just claimed by someone else or is no longer available.\" };\r\n    }\r\n\r\n    // 3. Refresh the dashboards\r\n    revalidatePath(\"/organisation\"); // Refresh NGO feed\r\n    revalidatePath(\"/donor\");        // Refresh Donor's \"Live Listings\"\r\n\r\n    return { success: \"Food claimed successfully! Please proceed for pickup.\" };\r\n  } catch (error) {\r\n    console.error(\"CLAIM_ERROR:\", error);\r\n    return { error: \"Failed to claim listing. Please try again.\" };\r\n  }\r\n}",
  "src\\features\\organisation\\components\\ClaimButton.js": "\"use client\";\r\n\r\nimport { useState, useTransition } from \"react\";\r\nimport { claimListing } from \"../actions\";\r\n\r\nexport default function ClaimButton({ listingId }) {\r\n  const [isPending, startTransition] = useTransition();\r\n  const [message, setMessage] = useState({ type: \"\", text: \"\" });\r\n\r\n  const handleClaim = () => {\r\n    setMessage({ type: \"\", text: \"\" });\r\n\r\n    startTransition(async () => {\r\n      const result = await claimListing(listingId);\r\n\r\n      if (result.error) {\r\n        setMessage({ type: \"error\", text: result.error });\r\n      } else {\r\n        setMessage({ type: \"success\", text: result.success });\r\n      }\r\n    });\r\n  };\r\n\r\n  if (message.type === \"success\") {\r\n    return (\r\n      <div className=\"w-full py-2 px-4 bg-green-50 text-green-700 text-xs font-bold rounded-lg border border-green-100 text-center\">\r\n        ‚úì {message.text}\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className=\"space-y-2\">\r\n      <button\r\n        onClick={handleClaim}\r\n        disabled={isPending}\r\n        className={`w-full py-3 rounded-xl font-bold text-sm transition-all ${\r\n          isPending \r\n            ? \"bg-slate-100 text-slate-400 cursor-not-allowed\" \r\n            : \"bg-emerald-600 text-white hover:bg-emerald-700 active:scale-95 shadow-sm shadow-emerald-100\"\r\n        }`}\r\n      >\r\n        {isPending ? \"Processing...\" : \"Claim Food Now\"}\r\n      </button>\r\n\r\n      {message.type === \"error\" && (\r\n        <p className=\"text-[10px] text-red-500 font-medium text-center bg-red-50 p-1 rounded\">\r\n          {message.text}\r\n        </p>\r\n      )}\r\n    </div>\r\n  );\r\n}",
  "src\\lib\\db.js": "import mongoose from \"mongoose\";\r\n\r\nconst MONGODB_URI = process.env.MONGODB_URI;\r\n\r\nif (!MONGODB_URI) {\r\n  throw new Error(\"Please define the MONGODB_URI environment variable\");\r\n}\r\n\r\nlet cached = global.mongoose || { conn: null, promise: null };\r\n\r\nasync function connectDB() {\r\n  if (cached.conn) return cached.conn;\r\n\r\nif (!cached.promise) {\r\n  console.log(\"Creating new MongoDB connection...\");\r\n  cached.promise = mongoose.connect(MONGODB_URI).then((m) => {\r\n    console.log(\"MongoDB Connected Successfully\");\r\n    return m;\r\n  });\r\n}\r\n  \r\n  cached.conn = await cached.promise;\r\n  return cached.conn;\r\n}\r\n\r\nexport default connectDB;",
  "src\\middleware.js": "import { withAuth } from \"next-auth/middleware\";\r\nimport { NextResponse } from \"next/server\";\r\n\r\nexport default withAuth(\r\n  function middleware(req) {\r\n    const token = req.nextauth.token;\r\n    const path = req.nextUrl.pathname; // Fixed: Use nextUrl, not nextrole\r\n\r\n    // 1. Prevent Donors from seeing NGO pages\r\n    if (path.startsWith(\"/organisation\") && token?.role !== \"ngo\") {\r\n      return NextResponse.redirect(new URL(\"/donor\", req.url));\r\n    }\r\n\r\n    // 2. Prevent NGOs from seeing Donor pages\r\n    if (path.startsWith(\"/donor\") && token?.role !== \"donor\") {\r\n      return NextResponse.redirect(new URL(\"/organisation\", req.url));\r\n    }\r\n  },\r\n  {\r\n    callbacks: {\r\n      // The middleware only runs if authorized returns true\r\n      authorized: ({ token }) => !!token,\r\n    },\r\n  }\r\n);\r\n\r\n// CRITICAL: This config determines where the middleware runs\r\nexport const config = { \r\n  matcher: [\r\n    /*\r\n     * Match only the dashboard routes. \r\n     * Do NOT match /log-in, /register, or /api routes.\r\n     */\r\n    \"/donor/:path*\", \r\n    \"/organisation/:path*\"\r\n  ] \r\n};",
  "src\\models\\Listing.js": "import mongoose from \"mongoose\";\r\n\r\nconst ListingSchema = new mongoose.Schema({\r\n  // Reference to the Donor (User model)\r\n  donorId: { \r\n    type: mongoose.Schema.Types.ObjectId, \r\n    ref: \"User\", \r\n    required: true \r\n  },\r\n  \r\n  // Basic Food Info\r\n  title: { \r\n    type: String, \r\n    required: [true, \"Please provide a title for the donation\"],\r\n    trim: true \r\n  },\r\n  description: { \r\n    type: String, \r\n    required: [true, \"Please describe the food items\"] \r\n  },\r\n  foodType: { \r\n    type: String, \r\n    enum: [\"Cooked\", \"Raw\", \"Packaged\", \"Other\"], \r\n    required: true \r\n  },\r\n  \r\n  // Quantity & Logistics\r\n  quantity: { \r\n    type: String, \r\n    required: [true, \"Please specify quantity (e.g., '10 kg' or '20 plates')\"] \r\n  },\r\n  pickupAddress: { \r\n    type: String, \r\n    required: [true, \"Pickup address is required\"] \r\n  },\r\n  \r\n  // Safety Timestamps\r\n  cookedTime: { \r\n    type: Date \r\n  }, \r\n  expiryTime: { \r\n    type: Date, \r\n    required: [true, \"Expiry time is critical for food safety\"] \r\n  },\r\n  \r\n  // Transaction State\r\n  status: { \r\n    type: String, \r\n    enum: [\"available\", \"claimed\", \"completed\", \"expired\"], \r\n    default: \"available\" \r\n  },\r\n  \r\n  // Reference to the NGO who claims the food\r\n  claimedBy: { \r\n    type: mongoose.Schema.Types.ObjectId, \r\n    ref: \"User\",\r\n    default: null\r\n  }\r\n}, { \r\n  timestamps: true // Automatically creates 'createdAt' and 'updatedAt'\r\n});\r\n\r\n// Create an index on status and expiryTime for faster queries on the NGO feed\r\nListingSchema.index({ status: 1, expiryTime: 1 });\r\n\r\nexport default mongoose.models.Listing || mongoose.model(\"Listing\", ListingSchema);",
  "src\\models\\User.js": "import mongoose from \"mongoose\";\r\n\r\nconst UserSchema = new mongoose.Schema({\r\n  name: { type: String, required: true }, // General Name or Admin Name\r\n  email: { type: String, unique: true, required: true },\r\n  password: { type: String, required: true },\r\n  role: { type: String, enum: [\"donor\", \"ngo\"], required: true },\r\n  status: { type: String, enum: [\"pending\", \"approved\", \"rejected\"], default: \"pending\" },\r\n  \r\n  // Specific Data for Donors\r\n  donorDetails: {\r\n    donorType: { type: String, enum: [\"Individual\", \"Restaurant\", \"Hotel\", \"Caterer\", \"Other\"] },\r\n    address: String,\r\n    phoneNumber: String,\r\n    businessLicense: String, // Optional FSSAI or business ID\r\n  },\r\n\r\n  // Specific Data for NGOs\r\n  ngoDetails: {\r\n    ngoName: String,\r\n    ngoType: { type: String, enum: [\"Food Bank\", \"Orphanage\", \"Shelter Home\", \"Community Kitchen\", \"Other\"] },\r\n    registrationType: { type: String, enum: [\"Society\", \"Trust\", \"Section 8 Company\", \"Other\"] },\r\n    registrationNumber: String,\r\n    ngoDarpanId: String,\r\n    reg12A: String,\r\n    reg80G: String,\r\n    fcraNumber: String,\r\n    address: String,\r\n    pinCode: String,\r\n    phoneNumber: String,\r\n    beneficiaryCapacity: Number,\r\n    documents: [String], // Array of URLs (e.g., from Cloudinary/AWS S3)\r\n  }\r\n}, { timestamps: true });\r\n\r\nexport default mongoose.models.User || mongoose.model(\"User\", UserSchema);"
}